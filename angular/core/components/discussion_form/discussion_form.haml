%form.discussion-forms{name: "discussionForm", ng-paste: "handlePaste($event)", ng_submit: "submit()", ng-disabled: "isDisabled"}
  .lmo-disabled-form{ng-show: "isDisabled"}
  %md-toolbar
    .md-toolbar-tools.lmo-flex__space-between
      %h1.lmo-h1.modal-title.lmo-flex__grow{translate: "discussion_form.new_discussion_title", ng-if: "discussion.isNew()"}
      %h1.lmo-h1.modal-title.lmo-flex__grow{translate: "discussion_form.edit_discussion_title", ng-if: "!discussion.isNew()"}
      %material_modal_header_cancel_button{aria-hidden: "true"}
  .md-dialog-content
    .thread-helptext{translate: "group_page.discussions_placeholder", ng-show: "discussion.isNew()"}

    %md-input-container.md-block{ng-show: "showGroupSelect"}
      %label{for: "discussion-group-field", translate: "discussion_form.group_label"}
      %md-select.discussion-form__group-select#discussion-group-field{ng-model: "discussion.groupId", placeholder: "{{'discussion_form.group_placeholder' | translate}}", ng-required: "true", ng-change: "restoreRemoteDraft(); updatePrivacy()"}
        %md-option{ng-value: "group.id", ng-repeat: "group in availableGroups() | orderBy: 'fullName' track by group.id"}
          {{group.fullName}}
      .md-errors-spacer

    .discussion-form__group-selected{ng-if: "discussion.groupId"}
      %md-input-container.md-block
        %label{for: "discussion-title", translate: "discussion_form.title_label"}
        .lmo-relative
          %input.discussion-form__title-input.lmo-primary-form-input#discussion-title{placeholder: "{{ 'discussion_form.title_placeholder' | translate }}", ng-model: "discussion.title", ng-required: "true", maxlength: "255"}
        %validation_errors{subject: "discussion", field: "title"}

      %outlet{name: "before-discussion-form-textarea", model: "discussion"}
      .lmo-relative.lmo-textarea-wrapper
        %md-input-container.md-block.md-no-errors{md-no-float: "true"}
          %textarea.lmo-relative.lmo-textarea.discussion-form__description-input.lmo-primary-form-input#discussion-context{ng-model: "discussion.description", placeholder: "{{ 'discussion_form.context_placeholder' | translate }}", mentio: "true", mentio-trigger-char: "'@'", mentio-items: "mentionables", mentio-template-url: "generated/components/thread_page/comment_form/mentio_menu.html", mentio-search: "fetchByNameFragment(term)", mentio-id: "discussion-field", ng-model-options: "{debounce: 150}"}
          .lmo-md-actions
            %div
            %emoji_picker{target-selector: "descriptionSelector"}
      %outlet{name: "after-discussion-form-textarea", model: "discussion"}

      .discussion-form__privacy-form{ng-if: "showPrivacyForm()"}
        %md-radio-group{ng-model: "discussion.private"}
          %md-radio-button.discussion-form__public{ng-model: "discussion.private", ng-value: "false"}
            %discussion_privacy_icon{discussion: "discussion", private: "false"}
          %md-radio-button.discussion-form__private{ng-model: "discussion.private", ng-value: "true"}
            %discussion_privacy_icon{discussion: "discussion", private: "true"}

      .discussion-form__privacy-notice{ng-if: "!showPrivacyForm()"}
        %label.discussion-form__privacy-notice
          %discussion_privacy_icon{discussion: "discussion"}

      .discussion-form__announcement-size{ng-if: "discussion.isNew()"}
        %md-checkbox.discussion-form__make-announcement{ng-model: "discussion.makeAnnouncement"}
        %label
          %i.material-icons.lmo-margin-right notifications
          %strong{translate: "discussion_form.make_announcement"}>
          %span.seperator{ng-if: "discussion.makeAnnouncement"}
          %span{translate: "discussion_form.notified_count", ng-if: "discussion.makeAnnouncement", translate-values: "{count: discussion.group().announcementRecipientsCount}"}

      .lmo-blank
        %attachment_preview{attachment: "attachment", mode: "thumb", ng-repeat: "attachment in discussion.newAttachments() | orderBy: 'id' track by attachment.id"}
      .lmo-md-actions
        %md-attachment-form.discussion-form__attachment-form{model: "discussion", ng-if: "discussion.groupId", show-label: "true"}
        %md-button.md-primary.md-raised.discussion-form__submit{type: "submit", ng-disabled: "submitIsDisabled || !discussion.groupId", translate: "common.action.start", ng-if: "discussion.isNew()" }
        %md-button.md-primary.md-raised.discussion-form__update{type: "submit", ng-disabled: "submitIsDisabled", translate: "common.action.save", ng-if: "!discussion.isNew()" }
      %validation_errors.discussion-form__attachment-errors{subject: "discussion", field: "file"}
